# PoC CVE 2025-24076

### Overview
Improper access control in Windows Cross Device Service allows an authorized attacker to elevate privileges locally.

### Exploit Setup
The affected versions are:
- Windows 11 Versions 24H2, 23H2, 22H2 (x64 and ARM64)
- Windows Server 2025
- Windows Server 2022 23H2 (Server Core installation)

Windows have patched it in their updates so we need to have a VM with the build prior to the updates.\
I found this https://archive.org/details/windows-11-24h2-iso_202501 iso file which was before the March 11 2025 updates (where this was patched).\
I was not able to test it due to bad infra for vm ðŸ˜¢.

After setting the vm, install python, gcc on windows.

### Exploit
When a user goes to settings-> Mobile Devices, the system loads the `CrossDevice.Streaming.Source.dll` present in `C:/ProgramData/CrossDevice`.
Even a low privilege user is able to overwrite the dll with a previously crafted `malicious.dll`.

I was able to mimic how the attack would work on my windows (without the vulnerable environment).

### Exploit Video
https://drive.google.com/file/d/10ZupCLdiatuaBwYgOAyYnxUtN2Tedfrz/view?usp=sharing.\
This is not on a vulnerable setup, just showing how it would work if there was one.
